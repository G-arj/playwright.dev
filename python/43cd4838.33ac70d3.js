(window.webpackJsonp=window.webpackJsonp||[]).push([[28],{147:function(e,t,a){"use strict";a.d(t,"a",(function(){return b})),a.d(t,"b",(function(){return h}));var n=a(0),r=a.n(n);function l(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function o(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function c(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?o(Object(a),!0).forEach((function(t){l(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):o(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function i(e,t){if(null==e)return{};var a,n,r=function(e,t){if(null==e)return{};var a,n,r={},l=Object.keys(e);for(n=0;n<l.length;n++)a=l[n],t.indexOf(a)>=0||(r[a]=e[a]);return r}(e,t);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(n=0;n<l.length;n++)a=l[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}var s=r.a.createContext({}),p=function(e){var t=r.a.useContext(s),a=t;return e&&(a="function"==typeof e?e(t):c(c({},t),e)),a},b=function(e){var t=p(e.components);return r.a.createElement(s.Provider,{value:t},e.children)},u={inlineCode:"code",wrapper:function(e){var t=e.children;return r.a.createElement(r.a.Fragment,{},t)}},m=r.a.forwardRef((function(e,t){var a=e.components,n=e.mdxType,l=e.originalType,o=e.parentName,s=i(e,["components","mdxType","originalType","parentName"]),b=p(a),m=n,h=b["".concat(o,".").concat(m)]||b[m]||u[m]||l;return a?r.a.createElement(h,c(c({ref:t},s),{},{components:a})):r.a.createElement(h,c({ref:t},s))}));function h(e,t){var a=arguments,n=t&&t.mdxType;if("string"==typeof e||n){var l=a.length,o=new Array(l);o[0]=m;var c={};for(var i in t)hasOwnProperty.call(t,i)&&(c[i]=t[i]);c.originalType=e,c.mdxType="string"==typeof e?e:n,o[1]=c;for(var s=2;s<l;s++)o[s]=a[s];return r.a.createElement.apply(null,o)}return r.a.createElement.apply(null,a)}m.displayName="MDXCreateElement"},97:function(e,t,a){"use strict";a.r(t),a.d(t,"frontMatter",(function(){return o})),a.d(t,"metadata",(function(){return c})),a.d(t,"toc",(function(){return i})),a.d(t,"default",(function(){return p}));var n=a(3),r=a(7),l=(a(0),a(147)),o={id:"core-concepts",title:"Core concepts"},c={unversionedId:"core-concepts",id:"core-concepts",isDocsHomePage:!1,title:"Core concepts",description:"Playwright provides a set of APIs to automate Chromium, Firefox and WebKit browsers. By using the Playwright API, you can write JavaScript code to create new browser pages, navigate to URLs and then interact with elements on a page.",source:"@site/docs/core-concepts.md",slug:"/core-concepts",permalink:"/python/docs/core-concepts",version:"current",sidebar:"docs",previous:{title:"Getting Started",permalink:"/python/docs/intro"},next:{title:"Debugging tools",permalink:"/python/docs/debug"}},i=[{value:"Browser",id:"browser",children:[]},{value:"Browser contexts",id:"browser-contexts",children:[]},{value:"Pages and frames",id:"pages-and-frames",children:[]},{value:"Selectors",id:"selectors",children:[]},{value:"Auto-waiting",id:"auto-waiting",children:[]},{value:"Execution contexts: Node.js and Browser",id:"execution-contexts-nodejs-and-browser",children:[]},{value:"Evaluation Argument",id:"evaluation-argument",children:[]},{value:"Object &amp; Element handles",id:"object--element-handles",children:[{value:"Handles Lifecycle",id:"handles-lifecycle",children:[]},{value:"Example: ElementHandle",id:"example-elementhandle",children:[]},{value:"Example: JSHandle",id:"example-jshandle",children:[]}]}],s={toc:i};function p(e){var t=e.components,a=Object(r.a)(e,["components"]);return Object(l.b)("wrapper",Object(n.a)({},s,a,{components:t,mdxType:"MDXLayout"}),Object(l.b)("p",null,"Playwright provides a set of APIs to automate Chromium, Firefox and WebKit browsers. By using the Playwright API, you can write JavaScript code to create new browser pages, navigate to URLs and then interact with elements on a page."),Object(l.b)("p",null,"Along with a test runner Playwright can be used to automate user interactions to validate and test web applications. The Playwright API enables this through the following primitives."),Object(l.b)("ul",null,Object(l.b)("li",{parentName:"ul"},Object(l.b)("a",Object(n.a)({parentName:"li"},{href:"#browser"}),"Browser")),Object(l.b)("li",{parentName:"ul"},Object(l.b)("a",Object(n.a)({parentName:"li"},{href:"#browser-contexts"}),"Browser contexts")),Object(l.b)("li",{parentName:"ul"},Object(l.b)("a",Object(n.a)({parentName:"li"},{href:"#pages-and-frames"}),"Pages and frames")),Object(l.b)("li",{parentName:"ul"},Object(l.b)("a",Object(n.a)({parentName:"li"},{href:"#selectors"}),"Selectors")),Object(l.b)("li",{parentName:"ul"},Object(l.b)("a",Object(n.a)({parentName:"li"},{href:"#auto-waiting"}),"Auto-waiting")),Object(l.b)("li",{parentName:"ul"},Object(l.b)("a",Object(n.a)({parentName:"li"},{href:"#execution-contexts-nodejs-and-browser"}),"Execution contexts: Node.js and Browser")),Object(l.b)("li",{parentName:"ul"},Object(l.b)("a",Object(n.a)({parentName:"li"},{href:"#evaluation-argument"}),"Evaluation Argument")),Object(l.b)("li",{parentName:"ul"},Object(l.b)("a",Object(n.a)({parentName:"li"},{href:"#object--element-handles"}),"Object & Element handles"))),Object(l.b)("br",null),Object(l.b)("h2",{id:"browser"},"Browser"),Object(l.b)("p",null,"A ",Object(l.b)("a",Object(n.a)({parentName:"p"},{href:"/python/docs/api/class-browser",title:"Browser"}),"Browser")," refers to an instance of Chromium, Firefox or WebKit. Playwright scripts generally start with launching a browser instance and end with closing the browser. Browser instances can be launched in headless (without a GUI) or headful mode."),Object(l.b)("pre",null,Object(l.b)("code",Object(n.a)({parentName:"pre"},{className:"language-python"}),"# async\n\nimport asyncio\nfrom playwright import async_playwright\n\nasync def main():\n    async with async_playwright() as p:\n        browser = await p.chromium.launch(headless=False)\n        await browser.close()\n\nasyncio.get_event_loop().run_until_complete(main())\n")),Object(l.b)("pre",null,Object(l.b)("code",Object(n.a)({parentName:"pre"},{className:"language-python"}),"# sync\n\nfrom playwright import sync_playwright\n\nwith sync_playwright() as p:\n    browser = p.chromium.launch(headless=False)\n    browser.close()\n")),Object(l.b)("p",null,"Launching a browser instance can be expensive, and Playwright is designed to maximize what a single instance can do through multiple browser contexts."),Object(l.b)("h4",{id:"api-reference"},"API reference"),Object(l.b)("ul",null,Object(l.b)("li",{parentName:"ul"},Object(l.b)("a",Object(n.a)({parentName:"li"},{href:"/python/docs/api/class-browser",title:"Browser"}),"Browser"))),Object(l.b)("br",null),Object(l.b)("h2",{id:"browser-contexts"},"Browser contexts"),Object(l.b)("p",null,"A ",Object(l.b)("a",Object(n.a)({parentName:"p"},{href:"/python/docs/api/class-browsercontext",title:"BrowserContext"}),"BrowserContext")," is an isolated incognito-alike session within a browser instance. Browser contexts are fast and cheap to create. Browser contexts can be used to parallelize isolated test executions."),Object(l.b)("pre",null,Object(l.b)("code",Object(n.a)({parentName:"pre"},{className:"language-python"}),"# async\n\nbrowser = await playwright.chromium.launch()\ncontext = await browser.new_context()\n")),Object(l.b)("pre",null,Object(l.b)("code",Object(n.a)({parentName:"pre"},{className:"language-python"}),"# sync\n\nbrowser = playwright.chromium.launch()\ncontext = browser.new_context()\n")),Object(l.b)("p",null,"Browser contexts can also be used to emulate multi-page scenarios involving mobile devices, permissions, locale and color scheme."),Object(l.b)("pre",null,Object(l.b)("code",Object(n.a)({parentName:"pre"},{className:"language-python"}),"# async\n\nimport asyncio\nfrom playwright import async_playwright\n\nasync def main():\n    async with async_playwright() as p:\n        iphone_11 = p.devices['iPhone 11 Pro']\n        browser = await p.chromium.launch()\n        context = await browser.new_context(\n            **iphone_11,\n            locale='de-DE',\n            geolocation={ 'longitude': 12.492507, 'latitude': 41.889938 },\n            permissions=['geolocation'],\n            color_scheme='dark',\n        )\n        page = await browser.newPage()\n        await browser.close()\n\nasyncio.get_event_loop().run_until_complete(main())\n")),Object(l.b)("pre",null,Object(l.b)("code",Object(n.a)({parentName:"pre"},{className:"language-python"}),"# sync\n\nfrom playwright import sync_playwright\n\nwith sync_playwright() as p:\n    iphone_11 = p.devices['iPhone 11 Pro']\n    browser = p.webkit.launch(headless=False)\n    context = browser.new_context(\n        **iphone_11,\n        locale='de-DE',\n        geolocation={ 'longitude': 12.492507, 'latitude': 41.889938 },\n        permissions=['geolocation']\n    )\n    browser.close()\n")),Object(l.b)("h4",{id:"api-reference-1"},"API reference"),Object(l.b)("ul",null,Object(l.b)("li",{parentName:"ul"},Object(l.b)("a",Object(n.a)({parentName:"li"},{href:"/python/docs/api/class-browsercontext",title:"BrowserContext"}),"BrowserContext")),Object(l.b)("li",{parentName:"ul"},Object(l.b)("a",Object(n.a)({parentName:"li"},{href:"/python/docs/api/class-browser#browsernewcontextoptions"}),"browser.new_context(**options)"))),Object(l.b)("br",null),Object(l.b)("h2",{id:"pages-and-frames"},"Pages and frames"),Object(l.b)("p",null,"A Browser context can have multiple pages. A ",Object(l.b)("a",Object(n.a)({parentName:"p"},{href:"/python/docs/api/class-page",title:"Page"}),"Page")," refers to a single tab or a popup window within a browser context. It should be used to navigate to URLs and interact with the page content."),Object(l.b)("pre",null,Object(l.b)("code",Object(n.a)({parentName:"pre"},{className:"language-python"}),"# async\n\npage = await context.new_page()\n\n# Navigate explicitly, similar to entering a URL in the browser.\nawait page.goto('http://example.com')\n# Fill an input.\nawait page.fill('#search', 'query')\n\n# Navigate implicitly by clicking a link.\nawait page.click('#submit')\n# Expect a new url.\nprint(page.url)\n\n# Page can navigate from the script - this will be picked up by Playwright.\n# window.location.href = 'https://example.com'\n")),Object(l.b)("pre",null,Object(l.b)("code",Object(n.a)({parentName:"pre"},{className:"language-python"}),"# sync\n\npage = context.new_page()\n\n# Navigate explicitly, similar to entering a URL in the browser.\npage.goto('http://example.com')\n# Fill an input.\npage.fill('#search', 'query')\n\n# Navigate implicitly by clicking a link.\npage.click('#submit')\n# Expect a new url.\nprint(page.url)\n\n# Page can navigate from the script - this will be picked up by Playwright.\n# window.location.href = 'https://example.com'\n")),Object(l.b)("blockquote",null,Object(l.b)("p",{parentName:"blockquote"},"Read more on ",Object(l.b)("a",Object(n.a)({parentName:"p"},{href:"/python/docs/navigations"}),"page navigation and loading"),".")),Object(l.b)("p",null,"A page can have one or more ",Object(l.b)("a",Object(n.a)({parentName:"p"},{href:"/python/docs/api/class-frame",title:"Frame"}),"Frame")," objects attached to it. Each page has a main frame and page-level interactions (like ",Object(l.b)("inlineCode",{parentName:"p"},"click"),") are assumed to operate in the main frame."),Object(l.b)("p",null,"A page can have additional frames attached with the ",Object(l.b)("inlineCode",{parentName:"p"},"iframe")," HTML tag. These frames can be accessed for interactions inside the frame."),Object(l.b)("pre",null,Object(l.b)("code",Object(n.a)({parentName:"pre"},{className:"language-python"}),"# async\n\n# Get frame using the frame's name attribute\nframe = page.frame('frame-login')\n\n# Get frame using frame's URL\nframe = page.frame(url=r'.*domain.*')\n\n# Get frame using any other selector\nframe_element_handle = await page.query_selector('.frame-class')\nframe = await frame_element_handle.content_frame()\n\n# Interact with the frame\nawait frame.fill('#username-input', 'John')\n")),Object(l.b)("pre",null,Object(l.b)("code",Object(n.a)({parentName:"pre"},{className:"language-python"}),"# sync\n\n# Get frame using the frame's name attribute\nframe = page.frame('frame-login')\n\n# Get frame using frame's URL\nframe = page.frame(url=r'.*domain.*')\n\n# Get frame using any other selector\nframe_element_handle = page.query_selector('.frame-class')\nframe = frame_element_handle.content_frame()\n\n# Interact with the frame\nframe.fill('#username-input', 'John')\n")),Object(l.b)("h4",{id:"api-reference-2"},"API reference"),Object(l.b)("ul",null,Object(l.b)("li",{parentName:"ul"},Object(l.b)("a",Object(n.a)({parentName:"li"},{href:"/python/docs/api/class-page",title:"Page"}),"Page")),Object(l.b)("li",{parentName:"ul"},Object(l.b)("a",Object(n.a)({parentName:"li"},{href:"/python/docs/api/class-frame",title:"Frame"}),"Frame")),Object(l.b)("li",{parentName:"ul"},Object(l.b)("a",Object(n.a)({parentName:"li"},{href:"/python/docs/api/class-page#pageframeoptions"}),"page.frame(**options)"))),Object(l.b)("br",null),Object(l.b)("h2",{id:"selectors"},"Selectors"),Object(l.b)("p",null,"Playwright can search for elements using CSS selectors, XPath selectors, HTML attributes like ",Object(l.b)("inlineCode",{parentName:"p"},"id"),", ",Object(l.b)("inlineCode",{parentName:"p"},"data-test-id")," and even text content."),Object(l.b)("p",null,"You can explicitly specify the selector engine you are using or let Playwright detect it."),Object(l.b)("p",null,"All selector engines except for XPath pierce shadow DOM by default. If you want to enforce regular DOM selection, you can use the ",Object(l.b)("inlineCode",{parentName:"p"},"*:light")," versions of the selectors. You don't typically need to though."),Object(l.b)("p",null,"Learn more about selectors and selector engines ",Object(l.b)("a",Object(n.a)({parentName:"p"},{href:"/python/docs/selectors"}),"here"),"."),Object(l.b)("p",null,"Some examples below:"),Object(l.b)("pre",null,Object(l.b)("code",Object(n.a)({parentName:"pre"},{className:"language-python"}),"# async\n\n# Using data-test-id= selector engine\nawait page.click('data-test-id=foo')\n")),Object(l.b)("pre",null,Object(l.b)("code",Object(n.a)({parentName:"pre"},{className:"language-python"}),"# sync\n\n# Using data-test-id= selector engine\npage.click('data-test-id=foo')\n")),Object(l.b)("pre",null,Object(l.b)("code",Object(n.a)({parentName:"pre"},{className:"language-python"}),"# async\n\n# CSS and XPath selector engines are automatically detected\nawait page.click('div')\nawait page.click('//html/body/div')\n")),Object(l.b)("pre",null,Object(l.b)("code",Object(n.a)({parentName:"pre"},{className:"language-python"}),"# sync\n\n# CSS and XPath selector engines are automatically detected\npage.click('div')\npage.click('//html/body/div')\n")),Object(l.b)("pre",null,Object(l.b)("code",Object(n.a)({parentName:"pre"},{className:"language-python"}),"# async\n\n# Find node by text substring\nawait page.click('text=Hello w')\n")),Object(l.b)("pre",null,Object(l.b)("code",Object(n.a)({parentName:"pre"},{className:"language-python"}),"# sync\n\n# Find node by text substring\npage.click('text=Hello w')\n")),Object(l.b)("pre",null,Object(l.b)("code",Object(n.a)({parentName:"pre"},{className:"language-python"}),"# async\n\n# Explicit CSS and XPath notation\nawait page.click('css=div')\nawait page.click('xpath=//html/body/div')\n")),Object(l.b)("pre",null,Object(l.b)("code",Object(n.a)({parentName:"pre"},{className:"language-python"}),"# sync\n\n# Explicit CSS and XPath notation\npage.click('css=div')\npage.click('xpath=//html/body/div')\n")),Object(l.b)("pre",null,Object(l.b)("code",Object(n.a)({parentName:"pre"},{className:"language-python"}),"# async\n\n# Only search light DOM, outside WebComponent shadow DOM:\nawait page.click('css:light=div')\n")),Object(l.b)("pre",null,Object(l.b)("code",Object(n.a)({parentName:"pre"},{className:"language-python"}),"# sync\n\n# Only search light DOM, outside WebComponent shadow DOM:\npage.click('css:light=div')\n")),Object(l.b)("p",null,"Selectors using the same or different engines can be combined using the ",Object(l.b)("inlineCode",{parentName:"p"},">>")," separator. For example,"),Object(l.b)("pre",null,Object(l.b)("code",Object(n.a)({parentName:"pre"},{className:"language-python"}),"# async\n\n# Click an element with text 'Sign Up' inside of a #free-month-promo.\nawait page.click('#free-month-promo >> text=Sign Up')\n")),Object(l.b)("pre",null,Object(l.b)("code",Object(n.a)({parentName:"pre"},{className:"language-python"}),"# sync\n\n# Click an element with text 'Sign Up' inside of a #free-month-promo.\npage.click('#free-month-promo >> text=Sign Up')\n")),Object(l.b)("pre",null,Object(l.b)("code",Object(n.a)({parentName:"pre"},{className:"language-python"}),"# async\n\n# Capture textContent of a section that contains an element with text 'Selectors'.\nsection_text = await page.eval_on_selector('*css=section >> text=Selectors', 'e => e.textContent')\n")),Object(l.b)("pre",null,Object(l.b)("code",Object(n.a)({parentName:"pre"},{className:"language-python"}),"# sync\n\n# Capture textContent of a section that contains an element with text 'Selectors'.\nsection_text = page.eval_on_selector('*css=section >> text=Selectors', 'e => e.textContent')\n")),Object(l.b)("br",null),Object(l.b)("h2",{id:"auto-waiting"},"Auto-waiting"),Object(l.b)("p",null,"Actions like ",Object(l.b)("a",Object(n.a)({parentName:"p"},{href:"/python/docs/api/class-page#pageclickselector-options"}),"page.click(selector, **options)")," and ",Object(l.b)("a",Object(n.a)({parentName:"p"},{href:"/python/docs/api/class-page#pagefillselector-value-options"}),"page.fill(selector, value, **options)")," auto-wait for the element to be visible and ",Object(l.b)("a",Object(n.a)({parentName:"p"},{href:"/python/docs/actionability"}),"actionable"),". For example, click will:"),Object(l.b)("ul",null,Object(l.b)("li",{parentName:"ul"},"wait for an element with the given selector to appear in the DOM"),Object(l.b)("li",{parentName:"ul"},"wait for it to become visible: have non-empty bounding box and no ",Object(l.b)("inlineCode",{parentName:"li"},"visibility:hidden")),Object(l.b)("li",{parentName:"ul"},"wait for it to stop moving: for example, wait until css transition finishes"),Object(l.b)("li",{parentName:"ul"},"scroll the element into view"),Object(l.b)("li",{parentName:"ul"},"wait for it to receive pointer events at the action point: for example, wait until element becomes non-obscured by other elements"),Object(l.b)("li",{parentName:"ul"},"retry if the element is detached during any of the above checks")),Object(l.b)("pre",null,Object(l.b)("code",Object(n.a)({parentName:"pre"},{className:"language-python"}),"# async\n\n# Playwright waits for #search element to be in the DOM\nawait page.fill('#search', 'query')\n")),Object(l.b)("pre",null,Object(l.b)("code",Object(n.a)({parentName:"pre"},{className:"language-python"}),"# sync\n\n# Playwright waits for #search element to be in the DOM\npage.fill('#search', 'query')\n")),Object(l.b)("pre",null,Object(l.b)("code",Object(n.a)({parentName:"pre"},{className:"language-python"}),"# async\n\n# Playwright waits for element to stop animating\n# and accept clicks.\nawait page.click('#search')\n")),Object(l.b)("pre",null,Object(l.b)("code",Object(n.a)({parentName:"pre"},{className:"language-python"}),"# sync\n\n# Playwright waits for element to stop animating\n# and accept clicks.\npage.click('#search')\n")),Object(l.b)("p",null,"You can explicitly wait for an element to appear in the DOM or to become visible:"),Object(l.b)("pre",null,Object(l.b)("code",Object(n.a)({parentName:"pre"},{className:"language-python"}),"# async\n\n# Wait for #search to appear in the DOM.\nawait page.wait_for_selector('#search', state='attached')\n# Wait for #promo to become visible, for example with `visibility:visible`.\nawait page.wait_for_selector('#promo')\n")),Object(l.b)("pre",null,Object(l.b)("code",Object(n.a)({parentName:"pre"},{className:"language-python"}),"# sync\n\n# Wait for #search to appear in the DOM.\npage.wait_for_selector('#search', state='attached')\n# Wait for #promo to become visible, for example with `visibility:visible`.\npage.wait_for_selector('#promo')\n")),Object(l.b)("p",null,"... or to become hidden or detached"),Object(l.b)("pre",null,Object(l.b)("code",Object(n.a)({parentName:"pre"},{className:"language-python"}),"# async\n\n# Wait for #details to become hidden, for example with `display:none`.\nawait page.wait_for_selector('#details', state='hidden')\n# Wait for #promo to be removed from the DOM.\nawait page.wait_for_selector('#promo', state='detached')\n")),Object(l.b)("pre",null,Object(l.b)("code",Object(n.a)({parentName:"pre"},{className:"language-python"}),"# sync\n\n# Wait for #details to become hidden, for example with `display:none`.\npage.wait_for_selector('#details', state='hidden')\n# Wait for #promo to be removed from the DOM.\npage.wait_for_selector('#promo', state='detached')\n")),Object(l.b)("h4",{id:"api-reference-3"},"API reference"),Object(l.b)("ul",null,Object(l.b)("li",{parentName:"ul"},Object(l.b)("a",Object(n.a)({parentName:"li"},{href:"/python/docs/api/class-page#pageclickselector-options"}),"page.click(selector, **options)")),Object(l.b)("li",{parentName:"ul"},Object(l.b)("a",Object(n.a)({parentName:"li"},{href:"/python/docs/api/class-page#pagefillselector-value-options"}),"page.fill(selector, value, **options)")),Object(l.b)("li",{parentName:"ul"},Object(l.b)("a",Object(n.a)({parentName:"li"},{href:"/python/docs/api/class-page#pagewaitforselectorselector-options"}),"page.wait_for_selector(selector, **options)"))),Object(l.b)("br",null),Object(l.b)("h2",{id:"execution-contexts-nodejs-and-browser"},"Execution contexts: Node.js and Browser"),Object(l.b)("p",null,"Playwright scripts run in your Node.js environment. Your page scripts run in the browser page environment. Those environments don't intersect, they are running in different virtual machines in different processes and even potentially on different computers."),Object(l.b)("p",null,"The ",Object(l.b)("a",Object(n.a)({parentName:"p"},{href:"/python/docs/api/class-page#pageevaluatepagefunction-options"}),"page.evaluate(page_function, **options)")," API can run a JavaScript function in the context of the web page and bring results back to the Node.js environment. Browser globals like ",Object(l.b)("inlineCode",{parentName:"p"},"window")," and ",Object(l.b)("inlineCode",{parentName:"p"},"document")," can be used in ",Object(l.b)("inlineCode",{parentName:"p"},"evaluate"),"."),Object(l.b)("pre",null,Object(l.b)("code",Object(n.a)({parentName:"pre"},{className:"language-python"}),"# async\n\nhref = await page.evaluate('() => document.location.href')\n")),Object(l.b)("pre",null,Object(l.b)("code",Object(n.a)({parentName:"pre"},{className:"language-python"}),"# sync\n\nhref = page.evaluate('() => document.location.href')\n")),Object(l.b)("p",null,"If the result is a Promise or if the function is asynchronous evaluate will automatically wait until it's resolved:"),Object(l.b)("pre",null,Object(l.b)("code",Object(n.a)({parentName:"pre"},{className:"language-python"}),'# async\n\nstatus = await page.evaluate("""async () => {\n  response = await fetch(location.href)\n  return response.status\n}""")\n')),Object(l.b)("pre",null,Object(l.b)("code",Object(n.a)({parentName:"pre"},{className:"language-python"}),'# sync\n\nstatus = page.evaluate("""async () => {\n  response = fetch(location.href)\n  return response.status\n}""")\n')),Object(l.b)("h2",{id:"evaluation-argument"},"Evaluation Argument"),Object(l.b)("p",null,"Playwright evaluation methods like ",Object(l.b)("a",Object(n.a)({parentName:"p"},{href:"/python/docs/api/class-page#pageevaluatepagefunction-options"}),"page.evaluate(page_function, **options)")," take a single optional argument. This argument can be a mix of ",Object(l.b)("a",Object(n.a)({parentName:"p"},{href:"https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/JSON/stringify#Description",title:"Serializable"}),"Serializable")," values and ",Object(l.b)("a",Object(n.a)({parentName:"p"},{href:"/python/docs/api/class-jshandle",title:"JSHandle"}),"JSHandle")," or ",Object(l.b)("a",Object(n.a)({parentName:"p"},{href:"/python/docs/api/class-elementhandle",title:"ElementHandle"}),"ElementHandle")," instances. Handles are automatically converted to the value they represent."),Object(l.b)("pre",null,Object(l.b)("code",Object(n.a)({parentName:"pre"},{className:"language-python"}),"# async\n\n# A primitive value.\nawait page.evaluate('num => num', 42)\n\n# An array.\nawait page.evaluate('array => array.length', [1, 2, 3])\n\n# An object.\nawait page.evaluate('object => object.foo', { 'foo': 'bar' })\n\n# A single handle.\nbutton = await page.query_selctor('button')\nawait page.evaluate('button => button.textContent', button)\n\n# Alternative notation using elementHandle.evaluate.\nawait button.evaluate('(button, from) => button.textContent.substring(from)', 5)\n\n# Object with multiple handles.\nbutton1 = await page.query_selector('.button1')\nbutton2 = await page.query_selector('.button2')\nawait page.evaluate(\"\"\"\n    o => o.button1.textContent + o.button2.textContent\"\"\",\n    { 'button1': button1, 'button2': button2 })\n\n# Object destructuring works. Note that property names must match\n# between the destructured object and the argument.\n# Also note the required parenthesis.\nawait page.evaluate(\"\"\"\n    ({ button1, button2 }) => button1.textContent + button2.textContent\"\"\",\n    { 'button1': button1, 'button2': button2 })\n\n# Array works as well. Arbitrary names can be used for destructuring.\n# Note the required parenthesis.\nawait page.evaluate(\"\"\"\n    ([b1, b2]) => b1.textContent + b2.textContent\"\"\",\n    [button1, button2])\n\n# Any non-cyclic mix of serializables and handles works.\nawait page.evaluate(\"\"\"\n    x => x.button1.textContent + x.list[0].textContent + String(x.foo)\"\"\",\n    { 'button1': button1, 'list': [button2], 'foo': None })\n")),Object(l.b)("pre",null,Object(l.b)("code",Object(n.a)({parentName:"pre"},{className:"language-python"}),"# sync\n\n# A primitive value.\npage.evaluate('num => num', 42)\n\n# An array.\npage.evaluate('array => array.length', [1, 2, 3])\n\n# An object.\npage.evaluate('object => object.foo', { 'foo': 'bar' })\n\n# A single handle.\nbutton = page.query_selector('button')\npage.evaluate('button => button.textContent', button)\n\n# Alternative notation using elementHandle.evaluate.\nbutton.evaluate('(button, from) => button.textContent.substring(from)', 5)\n\n# Object with multiple handles.\nbutton1 = page.query_selector('.button1')\nbutton2 = page.query_selector('.button2')\npage.evaluate(\"\"\"o => o.button1.textContent + o.button2.textContent\"\"\",\n    { 'button1': button1, 'button2': button2 })\n\n# Object destructuring works. Note that property names must match\n# between the destructured object and the argument.\n# Also note the required parenthesis.\npage.evaluate(\"\"\"\n    ({ button1, button2 }) => button1.textContent + button2.textContent\"\"\",\n    { 'button1': button1, 'button2': button2 })\n\n# Array works as well. Arbitrary names can be used for destructuring.\n# Note the required parenthesis.\npage.evaluate(\"\"\"\n    ([b1, b2]) => b1.textContent + b2.textContent\"\"\",\n    [button1, button2])\n\n# Any non-cyclic mix of serializables and handles works.\npage.evaluate(\"\"\"\n    x => x.button1.textContent + x.list[0].textContent + String(x.foo)\"\"\",\n    { 'button1': button1, 'list': [button2], 'foo': None })\n")),Object(l.b)("p",null,"Right:"),Object(l.b)("pre",null,Object(l.b)("code",Object(n.a)({parentName:"pre"},{className:"language-python"}),"# async\n\ndata = { 'text': 'some data', 'value': 1 }\n# Pass |data| as a parameter.\nresult = await page.evaluate(\"\"\"data => {\n  window.myApp.use(data)\n}\"\"\", data)\n")),Object(l.b)("pre",null,Object(l.b)("code",Object(n.a)({parentName:"pre"},{className:"language-python"}),"# sync\n\ndata = { 'text': 'some data', 'value': 1 }\n# Pass |data| as a parameter.\nresult = page.evaluate(\"\"\"data => {\n  window.myApp.use(data)\n}\"\"\", data)\n")),Object(l.b)("p",null,"Wrong:"),Object(l.b)("pre",null,Object(l.b)("code",Object(n.a)({parentName:"pre"},{className:"language-python"}),"# async\n\ndata = { 'text': 'some data', 'value': 1 }\nresult = await page.evaluate(\"\"\"() => {\n  # There is no |data| in the web page.\n  window.myApp.use(data)\n}\"\"\")\n")),Object(l.b)("pre",null,Object(l.b)("code",Object(n.a)({parentName:"pre"},{className:"language-python"}),"# sync\n\ndata = { 'text': 'some data', 'value': 1 }\nresult = page.evaluate(\"\"\"() => {\n  # There is no |data| in the web page.\n  window.myApp.use(data)\n}\"\"\")\n")),Object(l.b)("h4",{id:"api-reference-4"},"API reference"),Object(l.b)("ul",null,Object(l.b)("li",{parentName:"ul"},Object(l.b)("a",Object(n.a)({parentName:"li"},{href:"/python/docs/api/class-page#pageevaluatepagefunction-options"}),"page.evaluate(page_function, **options)")),Object(l.b)("li",{parentName:"ul"},Object(l.b)("a",Object(n.a)({parentName:"li"},{href:"/python/docs/api/class-frame#frameevaluatepagefunction-options"}),"frame.evaluate(page_function, **options)")),Object(l.b)("li",{parentName:"ul"},"[EvaluationArgument]")),Object(l.b)("br",null),Object(l.b)("h2",{id:"object--element-handles"},"Object & Element handles"),Object(l.b)("p",null,"Playwright can create Node-side handles to the page DOM elements or any other objects inside the page. These handles live in the Node.js process, whereas the actual objects reside in browser."),Object(l.b)("p",null,"There are two types of handles:"),Object(l.b)("ul",null,Object(l.b)("li",{parentName:"ul"},Object(l.b)("a",Object(n.a)({parentName:"li"},{href:"/python/docs/api/class-jshandle",title:"JSHandle"}),"JSHandle")," to reference any JavaScript objects in the page"),Object(l.b)("li",{parentName:"ul"},Object(l.b)("a",Object(n.a)({parentName:"li"},{href:"/python/docs/api/class-elementhandle",title:"ElementHandle"}),"ElementHandle")," to reference DOM elements in the page")),Object(l.b)("p",null,"Note that since any DOM element in the page is also a JavaScript object, Playwright's ",Object(l.b)("a",Object(n.a)({parentName:"p"},{href:"/python/docs/api/class-elementhandle",title:"ElementHandle"}),"ElementHandle")," extends ",Object(l.b)("a",Object(n.a)({parentName:"p"},{href:"/python/docs/api/class-jshandle",title:"JSHandle"}),"JSHandle"),"."),Object(l.b)("h3",{id:"handles-lifecycle"},"Handles Lifecycle"),Object(l.b)("ul",null,Object(l.b)("li",{parentName:"ul"},"Handles can be acquired using the page methods ",Object(l.b)("a",Object(n.a)({parentName:"li"},{href:"/python/docs/api/class-page#pageevaluatehandlepagefunction-options"}),"page.evaluate_handle(page_function, **options)"),", ",Object(l.b)("a",Object(n.a)({parentName:"li"},{href:"/python/docs/api/class-page#pageselector"}),"page.$(selector)")," or ",Object(l.b)("a",Object(n.a)({parentName:"li"},{href:"/python/docs/api/class-page#pageselector-1"}),"page.$$(selector)")," or their frame counterparts ",Object(l.b)("a",Object(n.a)({parentName:"li"},{href:"/python/docs/api/class-frame#frameevaluatehandlepagefunction-options"}),"frame.evaluate_handle(page_function, **options)"),", ",Object(l.b)("a",Object(n.a)({parentName:"li"},{href:"/python/docs/api/class-frame#frameselector"}),"frame.$(selector)")," or ",Object(l.b)("a",Object(n.a)({parentName:"li"},{href:"/python/docs/api/class-frame#frameselector-1"}),"frame.$$(selector)"),"."),Object(l.b)("li",{parentName:"ul"},"Once created, handles will retain object from ",Object(l.b)("a",Object(n.a)({parentName:"li"},{href:"https://developer.mozilla.org/en-US/docs/Web/JavaScript/Memory_Management"}),"garbage collection"),"."),Object(l.b)("li",{parentName:"ul"},"Handles will be ",Object(l.b)("strong",{parentName:"li"},"automatically disposed")," once the page or frame they belong to navigates or closes."),Object(l.b)("li",{parentName:"ul"},"Handles can be ",Object(l.b)("strong",{parentName:"li"},"manually disposed")," using ",Object(l.b)("a",Object(n.a)({parentName:"li"},{href:"/python/docs/api/class-jshandle#jshandledispose"}),"js_handle.dispose()")," method.")),Object(l.b)("h3",{id:"example-elementhandle"},"Example: ElementHandle"),Object(l.b)("pre",null,Object(l.b)("code",Object(n.a)({parentName:"pre"},{className:"language-python"}),"# async\n\n# The first parameter of the elementHandle.evaluate callback is the element handle points to.\nul_element_handle = await page.query_selector('ul')\nawait ul_element_handle.evaluate(\"ulElement => getComputedStyle(ulElement).getPropertyValue('display')\")\n")),Object(l.b)("pre",null,Object(l.b)("code",Object(n.a)({parentName:"pre"},{className:"language-python"}),"# sync\n\n# The first parameter of the elementHandle.evaluate callback is the element handle points to.\nul_element_handle = page.query_selector('ul')\nul_element_handle.evaluate(\"ulElement => getComputedStyle(ulElement).getPropertyValue('display')\")\n")),Object(l.b)("p",null,"Handles can also be passed as arguments to ",Object(l.b)("a",Object(n.a)({parentName:"p"},{href:"/python/docs/api/class-page#pageevaluatepagefunction-options"}),"page.evaluate(page_function, **options)")," function:"),Object(l.b)("pre",null,Object(l.b)("code",Object(n.a)({parentName:"pre"},{className:"language-python"}),"# async\n\nul_element_handle = await page.query_selector('ul')\nawait page.evaluate(\"uiElement => getComputedStyle(uiElement).getPropertyValue('display')\", uiElement)\n")),Object(l.b)("pre",null,Object(l.b)("code",Object(n.a)({parentName:"pre"},{className:"language-python"}),"# sync\n\nul_element_handle = page.query_selector('ul')\npage.evaluate(\"uiElement => getComputedStyle(uiElement).getPropertyValue('display')\", uiElement)\n")),Object(l.b)("h3",{id:"example-jshandle"},"Example: JSHandle"),Object(l.b)("pre",null,Object(l.b)("code",Object(n.a)({parentName:"pre"},{className:"language-python"}),'# async\n\n# Create a new array in the page, write a reference to it in\n# window.myArray and get a handle to it.\nmy_array_handle = await page.evaluate_handle("""() => {\n  window.myArray = [1]\n  return myArray\n}""")\n\n# Get current length of the array using the handle.\nlength = await page.evaluate("""\n  (arg) => arg.myArray.length""",\n  { \'myArray\': my_array_handle }\n)\n\n# Add one more element to the array using the handle\nawait page.evaluate("(arg) => arg.myArray.push(arg.newElement)", {\n  \'myArray\': my_array_handle,\n  \'newElement\': 2\n})\n\n# Get current length of the array using window.myArray reference.\nnew_length = await page.evaluate("() => window.myArray.length")\n\n# Release the object when it\'s no longer needed.\nawait my_array_handle.dispose()\n')),Object(l.b)("pre",null,Object(l.b)("code",Object(n.a)({parentName:"pre"},{className:"language-python"}),'# sync\n\n# Create a new array in the page, write a reference to it in\n# window.myArray and get a handle to it.\nmy_array_handle = page.evaluate_handle("""() => {\n  window.myArray = [1]\n  return myArray\n}""")\n\n# Get current length of the array using the handle.\nlength = page.evaluate("""\n  (arg) => arg.myArray.length""",\n  { \'myArray\': my_array_handle }\n)\n\n# Add one more element to the array using the handle\npage.evaluate("(arg) => arg.myArray.push(arg.newElement)", {\n  \'myArray\': my_array_handle,\n  \'newElement\': 2\n})\n\n# Get current length of the array using window.myArray reference.\nnew_length = page.evaluate("() => window.myArray.length")\n\n# Release the object when it\'s no longer needed.\nmy_array_handle.dispose()\n')),Object(l.b)("h4",{id:"api-reference-5"},"API reference"),Object(l.b)("ul",null,Object(l.b)("li",{parentName:"ul"},Object(l.b)("a",Object(n.a)({parentName:"li"},{href:"/python/docs/api/class-jshandle",title:"JSHandle"}),"JSHandle")),Object(l.b)("li",{parentName:"ul"},Object(l.b)("a",Object(n.a)({parentName:"li"},{href:"/python/docs/api/class-elementhandle",title:"ElementHandle"}),"ElementHandle")),Object(l.b)("li",{parentName:"ul"},Object(l.b)("a",Object(n.a)({parentName:"li"},{href:"/python/docs/api/class-page#pageevaluatehandlepagefunction-options"}),"page.evaluate_handle(page_function, **options)")),Object(l.b)("li",{parentName:"ul"},Object(l.b)("a",Object(n.a)({parentName:"li"},{href:"/python/docs/api/class-page#pageselector"}),"page.$(selector)")),Object(l.b)("li",{parentName:"ul"},Object(l.b)("a",Object(n.a)({parentName:"li"},{href:"/python/docs/api/class-page#pageselector-1"}),"page.$$(selector)")),Object(l.b)("li",{parentName:"ul"},Object(l.b)("a",Object(n.a)({parentName:"li"},{href:"/python/docs/api/class-jshandle#jshandleevaluatepagefunction-options"}),"js_handle.evaluate(page_function, **options)"))))}p.isMDXComponent=!0}}]);